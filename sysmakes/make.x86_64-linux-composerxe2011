# -*- makefile -*-
############################################################################
# System dependent Makefile options for
# Linux, Intel Fortran Compiler (version 8.x)
############################################################################

# Fortran 90 compiler
FC90 = ifort

# CPP compiler
CC = g++

# Options for the C compiler
CCOPT = -O2 -ip

CCOMP = -openmp

# Options for the Fortran 90 compiler 
FC90OPT = -O3 -unroll -openmp -ip -fexceptions -gcc-name=${CC} -gxx-name=${CC} -nofor-main

# Preprocessor (leave empty, if the compiler has a built in preprocessor)
CPP = cpp -traditional

# Options for preprocessing
CPPOPT = -DDEBUG=$(DEBUG)

# Fortran preprocessor (invokes CPP as defined above and process the results)
FPP = fpp

# Linker
LN = $(FC90)  

# Linker options
LNOPT = $(FC90OPT) #-static

# Override options for different DEBUG modes
ifeq ($(DEBUG),1)
    FC90OPT = -g -warn all -stand f03
    CCOPT = -g
endif
ifeq ($(DEBUG),2)
    FC90OPT = -g -warn all -stand f03
    CCOPT = -g
endif
ifeq ($(DEBUG),3)
    FC90OPT = -g  -warn all -check all -stand f03
    CCOPT = -g
endif

# Library options in general
MKL_LIBDIR = $(MKLROOT)/lib/intel64
LIBOPT = -L$(MKL_LIBDIR)

LNOPT += -I$(MKLROOT)/include

FC90OPT += -fPIC 
CCOPT += -fPIC 

# How to link specific libraries
LIB_LAPACK = 

STATIC_BLAS = $(MKLROOT)/lib/intel64/libmkl_blas95_ilp64.a $(MKLROOT)/lib/intel64/libmkl_lapack95_ilp64.a -Wl,--start-group $(MKLROOT)/lib/intel64/libmkl_intel_ilp64.a $(MKLROOT)/lib/intel64/libmkl_core.a $(MKLROOT)/lib/intel64/libmkl_intel_thread.a -Wl,--end-group -lpthread -lm
 
LIB_BLAS =  -L$(MKLROOT)/lib/intel64 -lmkl_intel_ilp64 -lmkl_core -lmkl_intel_thread -lpthread -lm 

LIB_SUPERLU =  $(ROOT)/../extlib/superlu20/c_bridge_zgssv20.$(ARCH).o $(ROOT)/../extlib/superlu20/SuperLU_2.0/superlu.$(ARCH).a
LIB_SPARSEKIT = $(ROOT)/../extlib/sparskit/zlibskit.$(ARCH).a
LIB_METIS = $(ROOT)/ext_libnegf/libmetis.$(ARCH).a
